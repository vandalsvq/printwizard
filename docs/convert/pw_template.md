---
layout: default
title:  "pw#template"
parent: Сериализатор
nav_order: 1
---

<details open markdown="block">
  <summary>
    Содержание
  </summary>
  {: .text-delta }
1. TOC
{:toc}
</details>

{: .note-title }
> Описание колонки "Экспорт"
> 
> * "+" - используется при экспорте
> * "!" - при экспорте изменяется, подробнее см. в [pw#template#file](pw_template_file.html)
> * (не заполнено) - не используется при экспорте

# pw#template

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| Реквизиты | [pw#template#attributes][1] | Основные реквизиты макета печатной формы | + |
| Таблицы   | [pw#template#tables][2]     | Данные таблиц макета печатной формы | + |
| Макет     | Произвольный                | Данные макета печатной формы | ! |

Макет может хранится в двух форматах:
* ТабличныйДокумент - для макетов в табличном документе
* ДвоичныеДанные - для макетов в формате *.docx

[в начало][0]

## pw#template#attributes

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| Имя               | Строка | Внутреннее имя макета печатной формы |  |
| Наименование      | Строка | Представление макета печатной формы |  |
| ЭтоРеестр         | Булево | Признак формирования реестра (по всем ссылкам) |  |
| КлючМакета        | Строка | Уникальный ключ макета сформированный программой |  |
| ВнешнийКлюч       | Строка | Уникальный ключ макета загруженный при импорте |  |
| ЭтоOfficeOpenXML  | Булево | Признак печатной формы в формате *.docx |  |
| ХешСумма          | Строка | Хеш сумма макета, используется для контроля наличия изменений |  |
| ОтметкаВремени    | Число | Отметка о времени последнего изменения |  |
| Описание          | [pw#template#about][3] | Дополнительная информация о печатной форме |  |

[в начало][0]

### pw#template#about

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| ПолноеНаименование        | Строка | Полное наименование печатной формы | + |
| НомерУнифицированнойФормы | Строка | № унифицированной формы | + |
| ОКУД                      | [pw_ОКУД][71] | ОКУД печатной формы (1) |  |
| НомерОКУД                 | Строка | Номер в ОКУД | + |
| НаименованиеОКУД          | Строка | Наименование в ОКУД | + |
| УтвержденаДокумент        | Строка |  | + |
| УтвержденаДата            | Дата |  | + |
| Комментарий               | Строка |  | + |

[в начало][0]

## pw#template#tables

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| Метаданные            | [pw#template#metadata#row][4] | Объекты метаданных, для которых создан макет | ! |
| Запросы               | [pw#template#queries#row][5] | Запросы к данным | ! |
| ЗапросыПоля           | [pw#template#query#fields#row][6] | Поля запросов данных | ! |
| Наборы                | [pw#template#datasets#row][7] | Наборы данных | ! |
| НаборыПоля            | [pw#template#dataset#fields#row][8] | Поля наборов данных | ! |
| НаборыПредставления   | [pw#template#dataset#wizards#row][9] | Настройки формирования ПолеКонструктора | ! |
| НаборыНумераторы      | [pw#template#dataset#numerators#row][10] | Настройки формирования ПолеНумератора | ! |
| НаборыСоединения      | [pw#template#dataset#joins#row][11] | Настройки соединения наборов | ! |
| Области               | [pw#template#areas#row][12] | Настройки областей макета печатной формы | ! |
| ОбластиПараметры      | [pw#template#area#parameters#row][13] | Настройки параметров областей макета | ! |
| ОбластиПредставления  | [pw#template#area#wizards#row][14] | Настройки формирования ПолеКонструктора параметра области | ! |
| ПараметрыЗапроса      | [pw#template#query#options#row][15] | Параметры для подстановки при выполнении запросов | ! |
| ПараметрыПечати       | [pw#template#print#options#row][16] | Параметры печати для табличного документа | ! |
| Алгоритмы             | [pw#template#algorithms#row][17] | Алгоритмы обработки событий макета | ! |

Значением структуры для общего макета выступает ТаблицаЗначений. Для экспорта данные преобразовываются в Массив со структурами внутри.

[в начало][0]

### pw#template#metadata#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки                 | Число | Порядковый номер | + |
| ИдентификаторОбъекта        | Справочник ИдентификаторыОбъектовМетаданных | Идентификатор объекта метаданных для печатной формы |  |
| ИдентификаторОбъектаИмя     | Строка | Имя объекта метаданных | + |
| КомандаПечати               | Булево | Создать команду печати по умолчанию | + |
| КомандаИдентификатор        | Строка | Идентификатор команды печати | + |
| КомандаПредставление        | Строка | Представление команды в меню Печать | + |
| КомандаПорядок              | Число | Значение от 1 до 100, указывающее порядок размещения команды по отношению к другим командам | + |
| КомандаФункциональныеОпции  | Строка | Имена функциональных опций, от которых зависит доступность команды печати, через запятую | + |
| КомандаПроверкаПроведения   | Булево | Признак необходимости проверки проведенности документов перед печатью | + |
| КомандаСразуНаПринтер       | Булево | Признак необходимости печати документов без предварительного просмотра | + |
| КомандаСписокФорм           | Строка | Имена форм, в которых должна отображаться команда, через запятую | + |

[в начало][0]

### pw#template#queries#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки               | Число | Порядковый номер | + |
| КлючСтроки                | Строка | Уникальный ключ запроса | + |
| ИмяЗапроса                | Строка |  | + |
| ТекстЗапроса              | Строка |  | + |
| ЭтоОбщийЗапрос            | Булево | Признак, что запрос не содержит отбора по ссылкам | + |
| ТипРезультата             | [pw_ТипыРезультатаЗапроса][72] | Тип данных в результате выполнения запроса | ! |
| ИмяВременнойТаблицы       | Строка | Имя временной таблицы полученной в результате запроса | + |
| КоличествоПолейЗапроса    | Число | Количество полей в запросе | + |
| ЕстьОшибки                | Булево | Признак наличия ошибок в запросе | + |
| ТекстОшибки               | Строка | Описание ошибок в запросе | + |
| ТекстРекомендаций         | Строка | Описание рекомендаций для текущего запроса | + |

[в начало][0]

### pw#template#query#fields#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки       | Число | Порядковый номер | + |
| КлючСтроки        | Строка | Уникальный ключ запроса-владельца | + |
| КлючСтрокиПоля    | Строка | Уникальный ключ поля | + |
| ПолеЗапроса       | Строка | Имя поля в запросе | + |
| ИмяПоля           | Строка | Имя поля для пользователя | + |
| ТипДанных         | Строка | Строковое представление типа данных в поле | + |
| ЭтоПолеПечати     | Булево | Поле, рекомендованное для печатной формы | + |
| ТипНомерКартинки  | Число | Номер картинки в коллекции pw_ТипыДанных | + |

[в начало][0]

### pw#template#datasets#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки           | Число | Порядковый номер | + |
| КлючСтроки            | Строка | Уникальный ключ набора | + |
| ИмяНабора             | Строка | Имя набора данных | + |
| ВидНабора             | [pw_ВидыНаборовДанных][73] | Вид формирования данных | ! |
| ИспользоватьВМакете   | Булево | Разрешить использовать набор в макете | + |
| КлючСтрокиЗапроса     | Строка | Ключ строки запроса - основы набора | + |
| ИмяЗапроса            | Строка | Имя запроса | + |
| АлгоритмОбработкиВТ   | Неопределено | Не используется |  |
| ПроизвольныйАлгоритм  | Строка | Текст алгоритма обработки набора данных | + |
| КоличествоПолей       | Число | Количество полей в наборе | + |

[в начало][0]

### pw#template#dataset#fields#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки             | Число | Порядковый номер | + |
| КлючСтроки              | Строка | Уникальный ключ набора-владельца | + |
| КлючСтрокиПоля          | Строка | Уникальный ключ поля | + |
| КлючСтрокиПоляВладелец  | Строка | Уникальный ключ поля-владельца, для полей с типом "ПолеСвойства" | + |
| ИмяПоля                 | Строка | Имя поля в наборе | + |
| ТипПоля                 | [pw_ТипыПолейНаборовДанных][74] | Тип поля | ! |
| Свойство                | ПланВидовХарактеристик ДополнительныеРеквизитыИСведения | Ссылка на свойство, для полей с типом "ПолеСвойства" |  |
| СвойствоИмя             | Строка | Значение реквизита "Имя" свойства | + |
| СвойствоТип             | Строка | Строковое представление типа данных свойства | + |
| ЭтоПолеПечати           | Булево | Поле, рекомендованное для печатной формы | + |
| ТипДанных               | Строка | Строковое представление типа данных в поле | + |
| ТекстАлгоритма          | Строка | Текст алгоритма, для полей с типом "ВычисляемоеПоле" | + |
| ЕстьДопРеквизиты        | Булево | Признак наличия доп. реквизитов для поля | + |
| ЕстьДопСвойства         | Булево | Признак наличия доп. свойств для поля | + |
| ТипНомерКартинки        | Число | Номер картинки в коллекции pw_ТипыДанных | + |
| КартинкаСвязи           | Число | Номер картинки в коллекции pw_КоллекцияПолеВМакете | + |

[в начало][0]

### pw#template#dataset#wizards#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки     | Число | Порядковый номер | + |
| КлючСтрокиПоля  | Строка | Уникальный ключ поля-владельца | + |
| ИмяПоля         | Строка | Имя поля из набора | + |
| Префикс         | Строка | Префикс, для подстановки перед значением поля | + |
| Формат          | Строка | Настройка форматирования значения | + |

[в начало][0]

### pw#template#dataset#numerators#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки     | Число | Порядковый номер | + |
| КлючСтрокиПоля  | Строка | Уникальный ключ поля-владельца | + |
| ИмяПоля         | Строка | Имя поля из набора | + |

[в начало][0]

### pw#template#dataset#joins#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки           | Число | Порядковый номер | + |
| КлючСтроки            | Строка | Уникальный ключ соединения | + |
| ИмяСоединения         | Строка | Имя для представления правой стороны соединения в доступных полях | + |
| ВидНабора             | [pw_ВидыНаборовДанных][73] | Вид формирования данных | ! |
| КлючСтрокиНабораЛево  | Строка | Ключ набора, левая сторона | + |
| КлючСтрокиНабораПраво | Строка | Ключ набора, правая сторона | + |
| КлючСтрокиПоляЛево    | Строка | Ключ поля набора, левая сторона | + |
| КлючСтрокиПоляПраво   | Строка | Ключ поля набора, правая сторона | + |
| ИмяНабораЛево         | Строка | Имя набора, левая сторона | + |
| ИмяНабораПраво        | Строка | Имя набора, правая сторона | + |
| ИмяПоляЛево           | Строка | Имя поля набора, левая сторона | + |
| ИмяПоляПраво          | Строка | Имя поля набора, правая сторона | + |

[в начало][0]

### pw#template#areas#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки               | Число | Порядковый номер | + |
| КлючСтроки                | Строка | Уникальный ключ области | + |
| ИмяОбласти                | Строка | Имя области как оно задано в макете | + |
| СпособВывода              | [pw_СпособыВыводаОбластиМакета][75] | Способ вывода области макета в печатную форму | ! |
| КлючСтрокиНабора          | Строка | Ключ набора для повтора при печати, для способа вывода ПоСтрокамКоллекции | + |
| ИмяНабора                 | Строка | Имя набора для повтора при печати, для способа вывода ПоСтрокамКоллекции | + |
| ИмяПараметраПереноса      | Строка | Имя спец. области, для способа вывода ПереносСтроки | + |
| ИмяКонтрольнойОбласти1    | Строка | Имя спец. области, для способа вывода ПереносСтроки | + |
| ИмяКонтрольнойОбласти2    | Строка | Имя спец. области, для способа вывода ПереносСтроки | + |
| ИмяДополнительнойОбласти  | Строка | Имя спец. области, для способа вывода ПереносСтроки | + |
| КоличествоПараметров      | Число | Количество параметров в области | + |
| ПолеСортировки            | Число | Поля для сортировки областей в по порядку | + |

[в начало][0]

### pw#template#area#parameters#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки               | Число | Порядковый номер | + |
| КлючСтрокиОбласти         | Строка | Ключ области-владельца | + |
| КлючСтроки                | Строка | Ключ параметра | + |
| ИмяПараметра              | Строка | Имя параметра, как оно задано в макете | + |
| ЭтоРасшифровка            | Булево | Признак, что параметр используется для расшифровки | + |
| ТипПараметра              | [pw_ТипыПараметровМакета][76] | Тип заполнения параметра данными | ! |
| КлючСтрокиНабора          | Строка | Ключ набора, для параметра с типом ЗначениеНабора | + |
| ЗначениеПараметра         | Строка | Значение для заполнения в наборе | + |
| ФорматЗначения            | Строка | Настройка форматирования значения, перед установкой в параметр | + |
| ТипДанных                 | Строка | Строковое представление типа данных в параметра | + |
| ТипНомерКартинки          | Число | Номер картинки в коллекции pw_ТипыДанных | + |

[в начало][0]

### pw#template#area#wizards#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки           | Число | Порядковый номер | + |
| КлючСтрокиПараметра   | Строка | Ключ параметра-владельца | + |
| КлючСтрокиНабора      | Строка | Ключ набора, поле которого использовано |  |
| ИмяПоля               | Строка | Имя поля из набора | + |
| Префикс               | Строка | Префикс, для подстановки перед значением поля | + |
| Формат                | Строка | Настройка форматирования значения | + |

[в начало][0]

### pw#template#query#options#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки       | Число | Порядковый номер | + |
| ИмяПараметра      | Строка | Имя параметра запроса | + |
| ТипДанных         | Строка | Строковое представление типа данных в параметра | + |
| ЭтоАлгоритм       | Булево | Признак, что параметр заполняется алгоритмом | + |
| ЭтоСписок         | Булево | Признак, что параметр заполняется списком значений | + |
| Значение          | Строка | Значение параметра в сериализованном значении XML | ! |
| ЗначениеТекст     | Строка | Строковое представление значения параметра | + |
| ТипНомерКартинки  | Число | Номер картинки в коллекции pw_ТипыДанных | + |

При экспорте, поле "Значение" заменяется из строкового значения на структуру [pw#value#internal][18].

[в начало][0]

### pw#template#print#options#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки       | Число | Порядковый номер | + |
| ИмяПараметра      | Строка | Имя параметра настройки печати | + |
| ЗначениеПараметра | Строка | Значение настройки печати | + |

[в начало][0]

### pw#template#algorithms#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки     | Число | Порядковый номер | + |
| ИмяСобытия      | Строка | Имя события | + |
| ТекстАлгоритма  | Строка | Текст алгоритма обработки события | + |
| ОписаниеСобытия | Строка | Описание события | + |

[в начало][0]

## pw#value#internal

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| СтрокаXML                 | Строка | Сериализованное в XML значение | + |
| ПолноеИмя                 | Строка | Полное имя объекта метаданных | + |
| Идентификатор             | Строка | Уникальный идентификатор ссылки | + |
| Реквизиты                 | Структура | Значения реквизитов для поиска по наименованию, коду и т.д. | + |
| ИмяПредопределенныхДанных | Строка | Имя предопределенного элемента | + |

- для простых типов, а также типов не связанных с метаданными конфигурации заполняется только значение СтрокаXML;
- для перечислений имя значения перечисления заполняется ИмяПредопределенныхДанных
- для всех ссылок заполняется Идентификатор
- поле "ИмяПредопределенныхДанных" заполняется для: Справочник, ПланВидовРасчета, ПланСчетов, ПланВидовХарактеристик (по возможности)
- поле "Реквизиты" заполняется следующим образом:
  - ПВХ.ДополнительныеРеквизитыИСведения: Имя
  - Спр.ВидыКонтактнойИнформации: ИмяПредопределенногоВида, Наименование, ИдентификаторДляФормул
  - Справочник,ПланВидовРасчета,ПланОбмена,ПланСчетов: Наименование, Код
  - Задача: Наименование, Номер
  - БизнесПроцесс,Документ: Дата, Номер

[в начало][0]

[0]: #pwtemplate
[1]: #pwtemplateattributes
[2]: #pwtemplatetables
[3]: #pwtemplateabout
[4]: #pwtemplatemetadatarow
[5]: #pwtemplatequeriesrow
[6]: #pwtemplatequeryfieldsrow
[7]: #pwtemplatedatasetsrow
[8]: #pwtemplatedatasetfieldsrow
[9]: #pwtemplatedatasetwizardsrow
[10]: #pwtemplatedatasetnumeratorsrow
[11]: #pwtemplatedatasetjoinsrow
[12]: #pwtemplateareasrow
[13]: #pwtemplateareaparametersrow
[14]: #pwtemplateareawizardsrow
[15]: #pwtemplatequeryoptionsrow
[16]: #pwtemplateprintoptionsrow
[17]: #pwtemplatealgorithmsrow
[18]: #pwvalueinternal

[71]: ../17_objects.html#pw_окуд
[72]: ../17_objects.html#pw_типырезультатазапроса
[73]: ../17_objects.html#pw_видынаборовданных
[74]: ../17_objects.html#pw_типыполейнаборовданных
[75]: ../17_objects.html#pw_способывыводаобластимакета
[76]: ../17_objects.html#pw_типыпараметровмакета
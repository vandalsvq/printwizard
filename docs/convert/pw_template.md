---
layout: default
title:  "pw#template"
parent: Сериализация
nav_order: 1
---

<details open markdown="block">
  <summary>
    Содержание
  </summary>
  {: .text-delta }
1. TOC
{:toc}
</details>

{: .note-title }
> Описание колонки "Экспорт"
> 
> "+" - используется при экспорте
> "!" - при экспорте изменяется, подробнее см. в [pw#template#file](pw_template_file.html)
> " " - не используется при экспорте

# pw#template

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| Реквизиты | [pw#template#attributes][1] | Основные реквизиты макета печатной формы | + |
| Таблицы | [pw#template#tables][2] | Данные таблиц макета печатной формы | + |
| Макет | Произвольный | Данные макета печатной формы | ! |

Макет может хранится в двух форматах:
* ТабличныйДокумент - для макетов в табличном документе
* ДвоичныеДанные - для макетов в формате *.docx

[в начало][0]

## pw#template#attributes

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| Имя               | Строка | Внутреннее имя макета печатной формы | + |
| Наименование      | Строка | Представление макета печатной формы | + |
| ЭтоРеестр         | Булево | Признак формирования реестра (по всем ссылкам) | + |
| КлючМакета        | Строка | Уникальный ключ макета сформированный программой | + |
| ВнешнийКлюч       | Строка | Уникальный ключ макета загруженный при импорте | + |
| ЭтоOfficeOpenXML  | Булево | Признак печатной формы в формате *.docx | + |
| ХешСумма          | Строка | Хеш сумма макета, используется для контроля наличия изменений | + |
| ОтметкаВремени    | Число | Отметка о времени последнего изменения | + |
| Описание          | [pw#template#about][3] |  | + |

[в начало][0]

### pw#template#about

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| ПолноеНаименование        | Строка | Полное наименование печатной формы | + |
| НомерУнифицированнойФормы | Строка | № унифицированной формы | + |
| ОКУД                      | Справочник.pw_ОКУД | ОКУД печатной формы (1) |  |
| НомерОКУД                 | Строка | Номер в ОКУД | + |
| НаименованиеОКУД          | Строка | Наименование в ОКУД | + |
| УтвержденаДокумент        | Строка |  | + |
| УтвержденаДата            | Дата |  | + |

[в начало][0]

## pw#template#tables

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| Метаданные            | [pw#template#metadata#row][4] | Объекты метаданных, для которых создан макет | ! |
| Запросы               | [pw#template#queries#row][5] | Запросы к данным | ! |
| ЗапросыПоля           | [pw#template#query#fields#row][6] | Поля запросов данных | ! |
| Наборы                | Коллекция | Наборы данных | ! |
| НаборыПоля            | Коллекция | Поля наборов данных | ! |
| НаборыПредставления   | Коллекция | Настройки формирования ПолеКонструктора | ! |
| НаборыНумераторы      | Коллекция | Настройки формирования ПолеНумератора | ! |
| НаборыСоединения      | Коллекция | Настройки соединения наборов | ! |
| Области               | Коллекция | Настройки областей макета печатной формы | ! |
| ОбластиПараметры      | Коллекция | Настройки параметров областей макета | ! |
| ОбластиПредставления  | Коллекция | Настройки формирования ПолеКонструктора параметра области | ! |
| ПараметрыЗапроса      | Коллекция | Параметры для подстановки при выполнении запросов | ! |
| ПараметрыПечати       | Коллекция | Параметры печати для табличного документа | ! |
| Алгоритмы             | Коллекция | Алгоритмы обработки событий макета | ! |

Значением структуры для общего макета выступает ТаблицаЗначений. Для экспорта данные преобразовываются в Массив со структурами внутри.

[в начало][0]

### pw#template#metadata#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
|  |  |  |  |

[в начало][0]

### pw#template#queries#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки               | Число | Порядковый номер строки запроса | + |
| КлючСтроки                | Строка | Уникальный ключ запроса | + |
| ИмяЗапроса                | Строка |  | + |
| ТекстЗапроса              | Строка |  | + |
| ЭтоОбщийЗапрос            | Булево | Признак, что запрос не содержит отбора по ссылкам | + |
| ТипРезультата             | Перечисление.pw_ТипыРезультатаЗапроса | Тип данных в результате выполнения запроса | ! |
| ИмяВременнойТаблицы       | Строка | Имя временной таблицы полученной в результате запроса | + |
| КоличествоПолейЗапроса    | Число | Количество полей в запросе | + |
| ЕстьОшибки                | Булево | Признак наличия ошибок в запросе | + |
| ТекстОшибки               | Строка | Описание ошибок в запросе | + |
| ТекстРекомендаций         | Строка | Описание рекомендаций для текущего запроса | + |

[в начало][0]

### pw#template#query#fields#row

| Имя | Тип | Описание | Экспорт |
|--|--|--|--|
| НомерСтроки       | Число | Порядковый номер поля в запросе | + |
| КлючСтроки        | Строка | Уникальный ключ запроса | + |
| КлючСтрокиПоля    | Строка | Уникальный ключ поля | + |
| ПолеЗапроса       | Строка | Имя поля в запросе | + |
| ИмяПоля           | Строка | Имя поля для пользователя | + |
| ТипДанных         | Строка | Строковое представление типа данных в поле | + |
| ЭтоПолеПечати     | Булево | Поле, рекомендованное для печатной формы | + |
| ТипНомерКартинки  | Число | Номер картинки в коллекции pw_ТипыДанных | + |

[в начало][0]


[0]: #pwtemplate
[1]: #pwtemplateattributes
[2]: #pwtemplatetables
[3]: #pwtemplateabout
[4]: #pwtemplatemetadatarow
[5]: #pwtemplatequeriesrow
[6]: #pwtemplatequeryfieldsrow
---
layout: default
title: Офисный документ
parent: Настройка макета
grand_parent: Документация
nav_order: 11
--- 

# Офисный документ

<p align="center">
    <a href="./../img/ch_02/36_page5.png"><img src="./../img/ch_02/36_page5.png" style="width:700px"></a>
    <br>Вид макета для офисного документа
</p>

Редактирование макета офисного документа необходимо выполнять в специализированном редакторе (Microsoft Office, OpenOffice и др.). После окончания подготовки макета, его необходимо записать и закрыть. После чего на закладке "Макет" произвести загрузку документа.

## Области макета

Печатная форма в формате *.docx формируется аналогично табличному документу, на основании блоков (областей).

Области и параметры задаются специальными конструкциями:

* `{v8 Область.ИмяОбласти}` - начало области, где *ИмяОбласти* - имя области
* `{v8 ИмяПараметра}` - параметр макета, где *ИмяПараметра* -  имя параметра, в который планируется установка значения
* `{/v8 Область.ИмяОбласти}` - окончание области (имя области повторяется из начальной части)

Для добавления картинки из базы знаний (в том числе QR-код) необходимо также добавить параметр. При этом, значение параметра должно принимать тип:

* картинка
* двоичные данные
* ссылка (ИмяСправочника)ПрисоединенныеФайлы

## Просмотр макета офисного документа

{: .warning-title }
> Безопасность
>
> Для предпросмотра, каждый файл помещается во временное хранилище файлов PrintWizard. Взаимодействие с временным хранилищем реализовано в закрытом модуле. Каждый файл имеет уникальное имя, не хранящееся в базе данных. Имена также зависят от конкретной лицензии. Доступ к временному храниищу есть только у вас и разработчика PrintWizard.
>
> Однако, если политикой безопасности вашей компании, передача данных третьим лицам недопустима, рекомендуем не использовать данный функционал.

Предпросмотр шаблонов в формате офисных документов реализован следующим образом:

* прикрепленный макет печатной формы отправляется во временное хранилище файлов Infostart PrintWizard
* формируется ссылка для отображения файла при помощи ресурса https://view.officeapps.live.com
* данная ссылка отображается на форме редактирования конструктора PrintWizard

Исходя из этого, для технического обеспечения возможности предпросмотра шаблона требуется:

* наличие соединения с сетью интернет
* доступ на сервере к https://storage.yandexcloud.net/ для загрузки файла во временное хранилище
* доступ на клиенте к https://view.officeapps.live.com/ для отображения файла на форме конструктора
* согласие пользователя на отправку данных во временное хранилище PrintWizard

Согласие установить для всех макетов в перснальных настройках (Раздел PrintWizard - Настройки). При этом вы можете всегда изменить согласие в форме отдельного макета.

{: .important-title }
> Время жизни файлов в хранилище
> 
> Все файлы, отправленные во временное хранилище имеют срок жизни от 7 до 30 дней. Файлы, добавленные в процессе подготовки печатной формы (до ее блокировки) будут хранится 7 дней. Файлы заблокированных макетов хранятся 30 дней. Это не значит, что они будут недоступны для просмотра по окончанию срока хранения. Они будут автоматически созданы при первом обращении.
> 
> Все файлы вашего хранилища вы можете посмотреть в форме настройки по гиперссылке "Файлы". Там же вы можете удалить все или отдельные файлы из временного хранилища навсегда. Но следует помнить, файл будет создан повторно, при открытии шаблона с предпросмотром.

{: .important-title }
> ВАЖНО
>
> Для версий до 2025.1 предпросмотр не работает и может выдавать ошибку.
> С версии 2025.1 до 2025.2.5 предпросмотр офисных документов был отключен. Если ваша
> Начиная с версии 2025.2.5 предпросмотр офисных документов возвращен.

---
layout: default
title: События
parent: Настройка макета
grand_parent: Документация
nav_order: 15
--- 

# События макета
{: .no_toc }

<details open markdown="block">
  <summary>
    Содержание
  </summary>
  {: .text-delta }
1. TOC
{:toc}
</details>

В процессе подготовки печатной формы, можно перехватить некоторые события конструктора и сделать обработку данных, внести изменения или вообще отказаться от печати макета или области. Для этого предусмотрены "Алгоритмы".

## ПередИнициализацией

Событие вызывается перед инициализацией макета. Позволяет выполнить предварительную подготовку данных или отказаться от выполнения печати.

| Имя параметра | Тип значения | Описание | Изменение |
|--|--|--|--|
| МассивОбъектов            | Массив | Массив ссылок для формирования печатных форм | + |
| Отказ                     | Булево | Признак отказа от формирования печатной формы | + |
| ДополнительныеСвойства    | Структура | Коллекция для передачи данных между событиями | + |

## ПриПолученииДанных

Событие вызывается после получения данных запросов. Позволяет выполнить обработку полученных таблиц данных.

| Имя параметра | Тип значения | Описание | Изменение |
|--|--|--|--|
| ДанныеМакета              | [ДанныеМакета][11] | Коллекция данных с результатами запросов | + |
| ДополнительныеСвойства    | Структура | Коллекция для передачи данных между событиями | + |

## ПередФормированием

Событие вызывается перед формированием печатного документа. Позволяет выполнить предварительные настройки или отказаться от дальнейшей обработки.

| Имя параметра | Тип значения | Описание | Изменение |
|--|--|--|--|
| ТабличныйДокумент         | ТабличныйДокумент | Табличный документ для вывода печатной формы | + |
| ТекущаяСсылка             | ЛюбаяСсылка | Ссылка для формирования печатной формы. Если выполняется печать реестра, значение пустое |  |
| НаборыДанных              | [НаборыДанных][12] | Данные наборов, подготовленные для использования при печати |  |
| Отказ                     | Булево | Признак отказа от формирования печатной формы | + |
| ДополнительныеСвойства    | Структура | Коллекция для передачи данных между событиями | + |

## ПередВыводомОбласти

Событие вызывается перед выводом области макета в печатный документ. Позволяет отказаться от дальнейшей обработки.

| Имя параметра | Тип значения | Описание | Изменение |
|--|--|--|--|
| ТабличныйДокумент         | ТабличныйДокумент | Табличный документ для вывода печатной формы | + |
| ТекущаяСсылка             | ЛюбаяСсылка | Ссылка для формирования печатной формы. Если выполняется печать реестра, значение пустое |  |
| НаборыДанных              | [НаборыДанных][12] | Данные наборов, подготовленные для использования при печати |  |
| Отказ                     | Булево | Признак отказа от формирования печатной формы | + |
| ИмяОбласти                | Строка | Имя области для вывода в печатную форму |  |
| ОбластьМакета             | ТабличныйДокумент | Сформированная область макета с заполненными значениями параметров | + |
| ДополнительныеСвойства    | Структура | Коллекция для передачи данных между событиями | + |

## ПослеВыводаОбласти

Событие вызывается после вывода области макета в печатный документ. Позволяет обработать выведенную область.

| Имя параметра | Тип значения | Описание | Изменение |
|--|--|--|--|
| ТабличныйДокумент         | ТабличныйДокумент | Табличный документ для вывода печатной формы | + |
| ТекущаяСсылка             | ЛюбаяСсылка | Ссылка для формирования печатной формы. Если выполняется печать реестра, значение пустое |  |
| НаборыДанных              | [НаборыДанных][12] | Данные наборов, подготовленные для использования при печати |  |
| ИмяОбласти                | Строка | Имя области для вывода в печатную форму |  |
| НачалоОбласти             | Число | Номер первой строки выведенной области в табличном документе |  |
| ДополнительныеСвойства    | Структура | Коллекция для передачи данных между событиями | + |

## ПослеФормирования

Событие вызывается после формирования печатного документа. Позволяет обработать результат.

| Имя параметра | Тип значения | Описание | Изменение |
|--|--|--|--|
| ТабличныйДокумент         | ТабличныйДокумент | Табличный документ для вывода печатной формы | + |
| ТекущаяСсылка             | ЛюбаяСсылка | Ссылка для формирования печатной формы. Если выполняется печать реестра, значение пустое |  |
| НаборыДанных              | [НаборыДанных][12] | Данные наборов, подготовленные для использования при печати |  |
| ДополнительныеСвойства    | Структура | Коллекция для передачи данных между событиями | + |

## Общие параметры событий

### Структура ДанныеМакета
* Ключ - имя запроса как оно задано в макете
* Значение - Структура - данные запроса, ключи структуры:
  * КлючСтроки - Строка - ключ запроса
  * Имя - Строка - имя запроса
  * Данные - ТаблицаЗначений - данные полученные в результате выполнения запроса

### Структура НаборыДанных
* Ключ - имя набора как оно задано в макете
* Значение - зависит от вида набора
  * Первая/Последняя строка - Структура
    * Ключ  - Строка - имя поля набора
    * Значение - Произвольный - значение поля набора
  * Соединение строк - Структура
    * Ключ - Строка - имя поля набора
    * Значение - Массив - массив уникальных значений поля набора
  * Многострочная коллекция - Структура - имена ключей:
    * Коллекция - ТаблицаЗначений - все данные набора
    * Строка - Структура - значения текущей строки для вывода, заполняется только для событий [ПередВыводомОбласти][1], [ПослеВыводаОбласти][2]
      * Ключ - Строка - имя поля набора
      * Значение - Произвольный - значение поля набора
    * Итог - Структура - массив итоговых значений набора (для числовых колонок)
      * Ключ - Строка - имя поля набора
      * Значение - Число - значение итога по колонке
    * КоличествоСтрок - Число - значение с количеством строк в наборе

[1]: #передвыводомобласти
[2]: #послевыводаобласти

[11]: #структура-данныемакета
[12]: #структура-наборыданных